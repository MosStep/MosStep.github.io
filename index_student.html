<!DOCTYPE html>
<html lang="th">
<head>
    <link rel="manifest" href="manifest.json">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Uni-Feed | ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏Ç‡πà‡∏≤‡∏ß‡∏£‡∏ß‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f7f8fa;
      display: flex;
      height: 100vh;
    }

    /* ‡πÄ‡∏°‡∏ô‡∏π‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢ */
    .sidebar {
      width: 250px;
      background-color: #1e293b;
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 20px 0;
    }

    .sidebar h2 {
      text-align: center;
      font-size: 22px;
      margin-bottom: 30px;
    }

    .menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .menu li {
      padding: 12px 25px;
      cursor: pointer;
      transition: 0.3s;
    }

    .menu li:hover, .menu li.active {
      background-color: #334155;
    }

    .logout {
      text-align: center;
      padding: 10px;
      background-color: #ef4444;
      cursor: pointer;
      transition: 0.3s;
    }

    .logout:hover {
      background-color: #dc2626;
    }

    /* ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤ */
    .main {
      flex: 1;
      padding: 20px 40px;
      overflow-y: auto;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .notification {
      position: relative;
      cursor: pointer;
    }

    .notification .dot {
      position: absolute;
      top: 0;
      right: 0;
      background-color: red;
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .feed {
      background-color: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .post {
      border-bottom: 1px solid #e5e7eb;
      padding: 10px 0;
    }

    .post:last-child {
      border-bottom: none;
    }

    .post h3 {
      margin: 0;
      color: #111827;
    }

    .post p {
      margin: 5px 0 0 0;
      color: #4b5563;
    }
    .tags { margin-top:8px }
    .tags .tag { display:inline-block; background:#eef2ff; color:#3730a3; padding:4px 8px; border-radius:999px; margin-right:6px; font-size:13px }
    .signature { margin-top:8px; font-size:13px; color:#6b7280; font-style:italic }
  </style>
</head>
<body>
  <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢ -->
  <div class="sidebar">
    <div>
      <h2>Uni-Feed</h2>
      <ul class="menu">
        <li class="active" onclick="showPage('dashboard', this)">üè† Dashboard</li>
        <li onclick="showPage('search', this)">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</li>
        <li onclick="showPage('follow', this)">‚≠ê ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</li>
        <li onclick="showPage('login', this)">‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</li>
      </ul>
    </div>
    <div class="logout" onclick="logout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</div>
  </div>

  <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
  <div class="main">
    <div class="header">
      <h1 id="pageTitle">Dashboard</h1>
        <div style="display:flex;align-items:center;gap:10px">
        <button id="refreshPostsBtn" style="padding:6px 10px;border-radius:6px;border:1px solid #cbd5e1;background:#fff;cursor:pointer">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
        <label style="display:flex;align-items:center;gap:6px;color:#374151;font-size:14px"><input id="autoRefreshChk" type="checkbox"> ‡∏≠‡∏≠‡πÇ‡∏ï‡πâ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</label>
        <div class="notification" onclick="showNotifications()" style="margin-left:8px">üîî<div class="dot" id="notifDot"></div></div>
        <div id="currentUserDisplay" style="font-size:14px;color:#374151;margin-left:8px"></div>
      </div>
      <div id="lastUpdated" style="font-size:12px;color:#6b7280;margin-top:8px">Last updated: -</div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="feed">
      <div id="postsContainer"></div>
    </div>

    <!-- Search -->
    <div id="search" class="feed" style="display:none">
      <input type="text" id="searchBox" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠ #‡πÅ‡∏ó‡πá‡∏Å..." style="width:100%;padding:10px;border:1px solid #ccc;border-radius:5px">
      <p style="margin-top:10px;color:#6b7280">üîé ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...</p>
    </div>

    <!-- Create Post (students cannot create) -->
    <!-- Removed: students are read-only; creation is available on teacher page -->

    <!-- My Posts -->
    <div id="myposts" class="feed" style="display:none">
      <h3>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h3>
      <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</p>
    </div>

    <!-- Follow -->
    <div id="follow" class="feed" style="display:none">
      <h3>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</h3>
      <div id="followTags"></div>
    </div>

    <!-- Login (placeholder) -->
    <div id="login" class="feed" style="display:none">
      <h3>‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</h3>
      <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
      <button onclick="window.location.href='Login.html'" style="display:inline-block;margin-top:10px;padding:8px 12px;background:#2563eb;color:#fff;border:none;border-radius:5px;cursor:pointer">‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</button>
    </div>
  </div>

  <script>
    function showPage(pageId, el) {
      // ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å feed
      document.querySelectorAll('.feed').forEach(div => div.style.display = 'none');
      document.getElementById(pageId).style.display = 'block';
      document.getElementById('pageTitle').innerText = pageId.charAt(0).toUpperCase() + pageId.slice(1);
      document.querySelectorAll('.menu li').forEach(li => li.classList.remove('active'));
      if (el && el.classList) el.classList.add('active');
      if(pageId === 'search'){
        const sb = document.getElementById('searchBox');
        if(sb){ sb.focus(); renderDashboard(sb.value.trim()); }
      }
    }

    function showNotifications() {
      // delegate to shared notifications handler if available
      if(typeof window.showNotificationsShared === 'function'){
        window.showNotificationsShared();
        return;
      }
      alert('‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ 1 ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà: #CS101 ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏•‡∏≤‡∏™‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ');
      const dot = document.getElementById('notifDot');
      if (dot) dot.style.display = 'none';
    }

    function postAnnouncement() {
      // Students are read-only; do not allow creating posts from student page
      alert('‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ');
    }

    function logout() {
      try{ localStorage.removeItem('unifeed_current_user'); }catch(e){}
      alert('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
      // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå Login.html ‡πÉ‡∏ô workspace
      window.location.href = 'Login.html';
    }

    // show current user display if available
    (function(){
      try{
        const raw = localStorage.getItem('unifeed_current_user');
        if(raw){ const u = JSON.parse(raw); const el = document.getElementById('currentUserDisplay'); if(el) el.innerText = (u.name ? u.name : u.username) + (u.role? (' | ' + u.role) : ''); }
      }catch(e){}
    })();
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js')
        .then(() => console.log('Service Worker registered!'))
        .catch(err => console.warn('Service Worker registration failed:', err));
    }

  </script>
  <script src="./app.js"></script>
</body>
</html>
